# Kilo Code 扩展调试报告

## 当前状态

### 扩展安装情况

- ✅ `kilocode.kilo-code@4.77.1` - 主要版本（正确）
- ⚠️ `cfq.kilo-code-cfq@4.77.1-cfq` - 旧版本（可能导致冲突）

### 问题描述

用户报告按钮重复出现，这通常是由于多个版本的扩展同时安装导致的。

## 已执行的修复步骤

1. **手动删除扩展文件夹**

    - 删除了扩展目录中的相关文件
    - 清理了全局存储数据

2. **禁用冲突版本**

    ```bash
    trae --disable-extension cfq.kilo-code-cfq
    ```

3. **重新安装正确版本**

    ```bash
    trae --install-extension bin/kilo-code-4.77.1.vsix --force
    ```

4. **验证安装状态**
    - 确认两个版本仍然存在
    - cfq版本已被禁用但仍显示在列表中

## 当前解决方案

### 方案1：使用禁用的cfq版本（推荐）

由于cfq版本已被禁用，理论上不会产生冲突。主要的`kilocode.kilo-code@4.77.1`版本应该正常工作。

### 方案2：完全清理重装

如果问题仍然存在，可以考虑：

1. 完全卸载Trae AI
2. 清理所有扩展数据
3. 重新安装Trae AI
4. 只安装正确版本的扩展

## 测试指南

### 手动测试步骤

1. 启动Trae AI
2. 按 `Cmd+Shift+P` 打开命令面板
3. 搜索 "kilo" 或 "settings"
4. 查找 "Kilo Code: Settings Button Clicked" 命令
5. 执行命令并验证设置面板是否正确打开
6. 检查UI中是否有重复的按钮

### 调试检查点

- [ ] 扩展是否正确激活
- [ ] 命令是否在命令面板中可见
- [ ] 设置面板是否正确打开
- [ ] 是否有重复的UI元素
- [ ] 浏览器控制台是否有错误信息

## 技术细节

### 扩展命令配置

命令ID: `kilo-code.settingsButtonClicked`

- 在 `package.json` 中正确定义
- 在 `registerCommands.ts` 中正确实现
- 绑定到设置按钮点击事件

### 可能的问题原因

1. **多版本冲突**: 两个版本同时注册相同的命令
2. **扩展激活时机**: 扩展可能在错误的时机激活
3. **UI重复渲染**: 多个扩展实例创建重复的UI元素

## 监控和日志

### 启用详细日志

```bash
trae --verbose --log-level debug src
```

### 检查扩展状态

```bash
trae --list-extensions --show-versions
```

### 浏览器开发者工具

- 打开控制台查看JavaScript错误
- 检查扩展激活日志
- 监控命令注册过程

## 下一步行动

1. **立即测试**: 使用上述手动测试步骤验证当前状态
2. **监控**: 观察是否还有重复按钮问题
3. **如果问题持续**: 考虑完全重装方案
4. **长期解决**: 确保构建过程只生成一个版本的扩展

## 联系信息

如果问题仍然存在，请提供：

- Trae AI版本信息
- 浏览器控制台错误日志
- 扩展激活的详细日志
- 重复按钮的截图

---

**报告生成时间**: $(date)
**扩展版本**: 4.77.1
**状态**: 等待用户测试验证
