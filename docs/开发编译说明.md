# 开发编译

## 安装依赖

```bash
pnpm install
```

## 构建扩展

```bash
    pnpm lint
    npx turbo build
    pnpm -C webview-ui run build
    pnpm -C src bundle

    pnpm lint && npx turbo build && pnpm -C webview-ui run build && pnpm -C src bundle
```

## 调试安装

```bash
npm run build && NODE_ENV=development VSCODE_DEBUG_MODE=true code --extensionDevelopmentPath=${PWD}/src
```

## 打包扩展

```bash
pnpm vsix
```

## 安装扩展

```bash
pnpm install:vsix

```

---

# 其他参考

## 卸载安装

### 先卸载

```bash
trae --list-extensions | grep -i kilocode
trae --uninstall-extension kilocode.kilo-code
cd /Users/chenfengqing/1-share-disk/disk/e/WEDev/WeDev/demo/cfqlilei-git/kilocode
```

### 再安装

```bash
### 打包并安装
pnpm install:vsix

## 安装扩展
trae --install-extension bin/kilo-code-4.77.1.vsix --force
code --install-extension bin/kilo-code-4.77.1.vsix
trae . --extensionDevelopmentPath=.
code . --extensionDevelopmentPath=.

code --extensionDevelopmentPath=./src --disable-extensions ./launch

## 列出已安装的扩展
trae --list-extensions --show-versions | grep -i kilo
## 启动查看
trae src
```

# 卸载VS Code扩展

```bash
trae --list-extensions | grep -i kilo
trae --uninstall-extension kilocode.kilo-code

trae --uninstall-extension kilo-code


## rm -rf "$HOME/Library/Application Support/Trae/extensions/kilocode.kilo-code-*"
## rm -rf "$HOME/Library/Application Support/Trae/extensions/cfq.kilo-code-cfq-*"

ls -la ~/.vscode/extensions/ | grep -i kilo
```

## 实时调试

### 启动调试

```bash
cd src && pnpm watch:bundle
```

### 类型检查

TypeScript检查来确认是否还有类型错误。

```bash
pnpm lint
cd src && npx tsc --noEmit
npm run check-types

pnpm lint

npx lint-staged
```

### 运行调试

    ```bash
        pnpm lint
        pnpm -C webview-ui run build
        pnpm -C src bundle
    ```
    2. 调试通过之后，执行如下代码:
    ```bash
    npm run build && NODE_ENV=development VSCODE_DEBUG_MODE=true code --extensionDevelopmentPath=${PWD}/src
    ```

### 编译安装

```bash
pnpm clean
pnpm install --frozen-lockfile

pnpm -C webview-ui run build
pnpm -C src bundle

- 打包成VSIX文件
pnpm vsix

- 组合命令，包含构建和安装，但可能跳过某些步骤
pnpm install:vsix
node scripts/install-vsix.js

# 安装VSIX文件

code --install-extension ./bin/kilo-code-4.77.12.vsix --force
code --extensionDevelopmentPath=./src --disable-extensions
node -e "const pkg = require('./src/package.json'); console.log('buildNumber:', pkg.buildNumber); console.log('version:', pkg.version);"


pnpm clean && pnpm vsix
pnpm build

npm run build
code --uninstall-extension kilocode.kilo-code

code --install-extension ./bin/kilo-code-4.77.12.vsix --force
code --list-extensions --show-versions | grep kilo
code . --extensionDevelopmentPath=.
```

### 安装扩展

```bash
trae --install-extension /Users/chenfengqing/1-share-disk/disk/e/WEDev/WeDev/demo/cfqlilei-git/kilocode/bin/kilo-code-4.77.1.vsix --force
trae --install-extension bin/kilo-code-4.77.1.vsix --force
```

## 检查安装

```bash
trae --list-extensions --show-versions | grep kilo
```

## 重启VS Code

```bash
trae --reload-window
```

##

# 提示词

## 代码解析提示词

对我提供的代码进行解释，要求逐行对业务逻辑、定义变量、调用方法，具体项逐项分节进行解析：

1. 业务逻辑

- 章节标题：对于if、循环等代码块，用 [功能简要描述]：if([条件])（伪代码）
- 章节内容：绘制代码逻辑图（含变量值变化）、时序图，并逐个步骤进行代码解析
- 示例：- ### 上下文参数校验：if (!context) {}
  [代码逻辑图]
  [代码解析]
- 对于较长的业务逻辑，继续拆分子章节，作为业务逻辑、定义变量进行解析

1. 定义变量

- 章节标题
    - 简短的变量定义，用“[变量意义描述]:变量定义”做章节标题
        - 示例：有效差异策略：const effectiveDiffStrategy = diffEnabled ? diffStrategy : undefined
    - 较长的变量定义，用简写方式做章节标题，比如调用方法等，把具体参数用“参数”代替
        - 示例：定义xxx：const { roleDefinition, baseInstructions } = getModeSelection(参数)
- 章节内容：
    - 列出代码片段
    - 对变量的赋值，如果有较长的赋值逻辑，则需要进行逐项逻辑解释

2. 调用方法：

- 章节标题
    - 如果是一行或简短的方法调用，可以直接做章节标题
    - 如果是较长的方法调用，用调用的方法伪代码做标题
    - 如果是业务逻辑比较复杂的，用业务逻辑进行解析

3. mermaid流程图节点，统一用["节点描述"]包起来
