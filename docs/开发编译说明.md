# 开发编译

## 安装依赖

```bash
pnpm install
```

## 构建扩展

```bash
pnpm build
```

## 打包扩展

```bash
pnpm vsix
```

## 安装扩展

### 先卸载

```bash
trae --list-extensions | grep -i kilocode
trae --uninstall-extension kilocode.kilo-code
cd /Users/chenfengqing/1-share-disk/disk/e/WEDev/WeDev/demo/cfqlilei-git/kilocode
```

### 再安装

```bash
### 打包并安装
pnpm install:vsix

## 安装扩展
trae --install-extension bin/kilo-code-4.77.1.vsix --force
code --install-extension bin/kilo-code-4.77.1.vsix
trae . --extensionDevelopmentPath=.
code . --extensionDevelopmentPath=.

## 列出已安装的扩展
trae --list-extensions --show-versions | grep -i kilo
## 启动查看
trae src
```

# 卸载VS Code扩展

```bash
trae --list-extensions | grep -i kilo
trae --uninstall-extension kilocode.kilo-code

trae --uninstall-extension kilo-code


## rm -rf "$HOME/Library/Application Support/Trae/extensions/kilocode.kilo-code-*"
## rm -rf "$HOME/Library/Application Support/Trae/extensions/cfq.kilo-code-cfq-*"

ls -la ~/.vscode/extensions/ | grep -i kilo
```

## 实时调试

### 启动调试

```bash
cd src && pnpm watch:bundle
```

### 类型检查

TypeScript检查来确认是否还有类型错误。

```bash
cd src && npx tsc --noEmit

pnpm lint

npx lint-staged
```

### 运行调试

- 点击运行，会启动双窗口调模式

    - Bundle监听服务 ： src 目录下的 pnpm watch:bundle
    - 开发服务器 ： webview-ui 目录下的 npm run dev -执行以上，并运行调试，会启动开发服务器来支持HMR（热模块替换）功能：

    1. 修改代码之后，能够需要停止并重新运行launch.json"Run Extension",运行debug，实时调试Vscode插件
    2. 调试如果不通过，则继续修改代码
    3. 调试通过之后，需要重新打包，pnmp vsix
    4. 重新打包后，需要重新安装，trae --install-extension bin/kilo-code-[version].vsix --force
    5. 重新安装后，需要重新启动，trae src --extensionDevelopmentPath=.
    6. 重新启动后，需要重新打开VS Code，code . --extensionDevelopmentPath=.
    7. 根据本次修改的内容，用链式思考，进行测试，测试如果有问题，需要重复

### 编译安装

```bash
pnpm clean
pnpm install --frozen-lockfile

pnpm -C webview-ui run build
pnpm -C src bundle

- 打包成VSIX文件
pnpm vsix

- 组合命令，包含构建和安装，但可能跳过某些步骤
pnpm install:vsix

# 安装VSIX文件

code --install-extension ./bin/kilo-code-4.77.12.vsix --force
code --extensionDevelopmentPath=./src --disable-extensions
node -e "const pkg = require('./src/package.json'); console.log('buildNumber:', pkg.buildNumber); console.log('version:', pkg.version);"


pnpm clean && pnpm vsix
pnpm build

npm run build
code --uninstall-extension kilocode.kilo-code

code --install-extension ./bin/kilo-code-4.77.12.vsix --force
code --list-extensions --show-versions | grep kilo
code . --extensionDevelopmentPath=.
```

### 安装扩展

```bash
trae --install-extension /Users/chenfengqing/1-share-disk/disk/e/WEDev/WeDev/demo/cfqlilei-git/kilocode/bin/kilo-code-4.77.1.vsix --force
trae --install-extension bin/kilo-code-4.77.1.vsix --force
```

## 检查安装

```bash
trae --list-extensions --show-versions | grep kilo
```

## 重启VS Code

```bash
trae --reload-window
```

##
